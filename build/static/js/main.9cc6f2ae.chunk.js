(this["webpackJsonpmeal-client"]=this["webpackJsonpmeal-client"]||[]).push([[0],{134:function(e,a,t){e.exports=t(169)},156:function(e,a,t){},169:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(26),s=t.n(l),o=t(43),c=t(44),m=t(83),i=t(76),d=t(75),u=t(61),p=t(7),b=(t(139),t(39)),E=t.n(b);t(156);function f(){return JSON.parse(localStorage.getItem("user"))}function h(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.accessToken?{"x-access-token":e.accessToken}:{}}var g=t(184),v=t(182),y=t(106);var N=function(e){return r.a.createElement(g.a,{sticky:"top",collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark"},r.a.createElement(y.LinkContainer,{to:"/"},r.a.createElement(g.a.Brand,null,"Meals")),r.a.createElement(g.a.Toggle,null),r.a.createElement(g.a.Collapse,null,r.a.createElement(v.a,{className:"mr-auto"},e.isLoggedIn&&r.a.createElement(v.a.Link,{href:"/login",onClick:e.onLogout},"Logout"),!e.isLoggedIn&&r.a.createElement(y.LinkContainer,{to:"/login"},r.a.createElement(v.a.Link,null,"Login")),!e.isLoggedIn&&r.a.createElement(y.LinkContainer,{to:"/signup"},r.a.createElement(v.a.Link,null,"Signup")))))},w=t(13),k=t(9),S=k.a().shape({username:k.c().required("Username is required"),email:k.c().email("Email is invalid").required("Email is required"),password:k.c().min(10,"Password must be at least 10 characters long").required("Password is required"),confirmPassword:k.c().oneOf([k.b("password"),null],"Passwords must match").required("Must confirm password")}),M=function(e){Object(i.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).state={message:""},n}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"jumbotron"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 offset-md-3"},r.a.createElement("h3",{className:"pb-2"},"Signup"),r.a.createElement(w.c,{initialValues:{username:"",email:"",password:"",confirmPassword:""},validationSchema:S,onSubmit:function(a,t){e.props.onSignup(a.username,a.email,a.password).then((function(a){a.data.message&&"Signed up successfully!"===a.data.message&&(e.setState({message:a.data.message}),setTimeout((function(){e.props.history.push("/login")}),2e3))})).catch((function(a){var n=a.response&&a.response.data&&a.response.data.message||a.message||a.toString();e.setState({message:n}),t.setSubmitting(!1)}))}},(function(a){var t=a.errors,n=a.touched;return r.a.createElement(w.b,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement(w.a,{name:"username",type:"text",className:"form-control"}),n.username&&t.username&&r.a.createElement("div",{className:"alert alert-danger mt-2"},t.username)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email Address"),r.a.createElement(w.a,{name:"email",type:"text",className:"form-control"}),n.email&&t.email&&r.a.createElement("div",{className:"alert alert-danger mt-2"},t.email)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(w.a,{name:"password",type:"password",className:"form-control"}),n.password&&t.password&&r.a.createElement("div",{className:"alert alert-danger mt-2"},t.password)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm Password"),r.a.createElement(w.a,{name:"confirmPassword",type:"password",className:"form-control"}),n.confirmPassword&&t.confirmPassword&&r.a.createElement("div",{className:"alert alert-danger mt-2"},t.confirmPassword)),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary mr-2"},"Sign Up"),r.a.createElement("button",{type:"reset",className:"btn btn-secondary"},"Reset")),e.state.message&&r.a.createElement("div",{className:"Signed up successfully!"===e.state.message?"alert alert-success mt-2":"alert alert-danger mt-2"},e.state.message))}))))))}}]),t}(r.a.Component),O=Object(p.o)(M),U=k.a().shape({username:k.c().required("Please enter your username."),password:k.c().required("Please enter your password.")}),B=function(e){Object(i.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).state={message:""},n}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"jumbotron"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 offset-md-3"},r.a.createElement("h3",{className:"pb-2"},"Meals App"),r.a.createElement(w.c,{initialValues:{username:"",password:""},validationSchema:U,onSubmit:function(a,t){e.props.onLogin(a.username,a.password).then((function(t){t.data.accessToken&&(localStorage.setItem("user",JSON.stringify(t.data)),localStorage.setItem("username",a.username)),e.props.onLoginSuccess(),e.props.history.push("/meals")})).catch((function(a){var n=a.response&&a.response.data&&a.response.data.message||a.message||a.toString();e.setState({message:n}),t.setSubmitting(!1)}))}},(function(a){var t=a.errors,n=a.touched,l=a.isSubmitting,s=a.isValidating;return r.a.createElement(w.b,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"align-middle",htmlFor:"username"},"Username"),r.a.createElement(w.a,{name:"username",type:"text",className:"form-control"}),n.username&&t.username&&r.a.createElement("div",{className:"alert alert-danger mt-2"},t.username)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(w.a,{name:"password",type:"password",className:"form-control"}),n.password&&t.password&&r.a.createElement("div",{className:"alert alert-danger mt-2"},t.password)),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary",type:"submit",disabled:l},(l||s)&&r.a.createElement("span",{className:"spinner-border spinner-border-sm"}),r.a.createElement("span",null,"Login"))),e.state.message&&r.a.createElement("div",{className:"alert alert-danger mt-2"},e.state.message))}))))))}}]),t}(r.a.Component),L=Object(p.o)(B),j=t(176),x=t(16),C=t.n(x),P=t(34),D=t(179),q=t(180),H=t(178),Y=t(125),_=t(181),I=t(174),F=t(175),T=t(31),A=t(27),J={meal_url:"https://ls-meal-app.herokuapp.com/api/meals",login_url:"https://ls-meal-app.herokuapp.com/api/login",signup_url:"https://ls-meal-app.herokuapp.com/api/signup"},V=J.meal_url,W=new(function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,[{key:"newMeal",value:function(e,a,t){return E.a.post(V,{date:e,meal_type:a,meal_desc:t},{headers:h()})}},{key:"editMeal",value:function(e,a,t){return E.a.put(V,{date:e,meal_type:a,meal_desc:t},{headers:h()})}},{key:"deleteMeal",value:function(e,a){return E()({url:V,method:"delete",headers:h(),data:{date:e,meal_type:a}})}}]),e}()),z=k.a().shape({description:k.c().required("Please describe your meal."),date:k.c().required(),type:k.c().required()}),G=["Meal details updated successfully!","Meal successfully deleted."];function R(e){var a=r.a.useState(""),t=Object(P.a)(a,2),n=t[0],l=t[1],s=C()(e.blob.date,"MM-DD-YYYY").format("MMMM Do"),o=e.blob.type.charAt(0).toUpperCase()+e.blob.type.slice(1);return r.a.createElement(_.a,{show:e.show,onHide:e.onHide,size:"lg",centered:!0},r.a.createElement(_.a.Header,{closeButton:!0},r.a.createElement(_.a.Title,null,o," for ",s)),r.a.createElement(_.a.Body,null,n.length>0?r.a.createElement(I.a,{variant:G.includes(n)?"success":"danger"},n):r.a.createElement(w.c,{initialValues:{date:e.blob.date,type:e.blob.type,description:e.blob.description},validationSchema:z,onSubmit:function(e,a){W.editMeal(e.date,e.type,e.description).then((function(e){l(e.data.message)})).catch((function(e){e.response?l(e.response.data.message):e.request?l(e.request):l(e.message)})),a.setSubmitting(!1)}},(function(e){var a=e.errors,t=e.touched;return r.a.createElement(w.b,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"description"},"Meal description"),r.a.createElement(w.a,{name:"description",component:"textarea",className:"form-control",rows:"6"}),r.a.createElement("small",{className:"form-text text-muted"},"Change of heart? New meal ideas are always welcome."),t.description&&a.description&&r.a.createElement("div",{className:"alert alert-danger mt-2"},a.description)),r.a.createElement(F.a,{className:"float-right",type:"submit"},"Submit"))}))),r.a.createElement(_.a.Footer,null,""===n?r.a.createElement(F.a,{variant:"danger",onClick:function(){W.deleteMeal(e.blob.date,e.blob.type).then((function(e){l(e.data.message)})).catch((function(e){e.response?(l(e.response.data.message),console.log("first branch")):e.request?(l(e.request),console.log("second branch")):(console.log("third branch"),l(e.message)),console.log(e)}))}},r.a.createElement(T.a,{icon:A.e})," Delete Meal"):r.a.createElement(F.a,{variant:"success",onClick:function(){e.onHide(),l("")}},r.a.createElement(T.a,{icon:A.d})," Got it")))}var $=function(e){var a=r.a.useState(!1),t=Object(P.a)(a,2),n=t[0],l=t[1];return r.a.createElement(j.a,{fluid:!0},r.a.createElement(F.a,{className:"fill-button",variant:"info",onClick:function(){return l(!0)}},r.a.createElement(T.a,{className:"mr-1",icon:A.a})," Modify"),r.a.createElement(R,{show:n,onHide:function(){l(!1),e.onUpdate()},blob:e.blob}))},K=k.a().shape({description:k.c().required("Please describe your meal."),date:k.c().required(),type:k.c().required()});function Q(e){var a=r.a.useState(""),t=Object(P.a)(a,2),n=t[0],l=t[1],s=C()(e.blob.date,"MM-DD-YYYY").format("MMMM Do"),o=e.blob.type.charAt(0).toUpperCase()+e.blob.type.slice(1);return r.a.createElement(_.a,{show:e.show,onHide:e.onHide,size:"lg",centered:!0},r.a.createElement(_.a.Header,{closeButton:!0},r.a.createElement(_.a.Title,null,o," for ",s)),r.a.createElement(_.a.Body,null,n.length>0?r.a.createElement(I.a,{variant:"Meal scheduled successfully!"===n?"success":"danger"},n):r.a.createElement(w.c,{initialValues:{date:e.blob.date,type:e.blob.type,description:""},validationSchema:K,onSubmit:function(e,a){W.newMeal(e.date,e.type,e.description).then((function(e){l(e.data.message)})).catch((function(e){e.response?l(e.response.data.message):e.request?l(e.request):l(e.message)}))}},(function(e){var a=e.errors,t=e.touched;return r.a.createElement(w.b,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"description"},"Meal description"),r.a.createElement(w.a,{name:"description",component:"textarea",className:"form-control",rows:"6"}),r.a.createElement("small",{className:"form-text text-muted"},"Describe the meal you will prepare."),t.description&&a.description&&r.a.createElement("div",{className:"alert alert-danger mt-2"},a.description)),r.a.createElement(F.a,{className:"float-right",type:"submit"},"Submit"))}))),n.length>0&&r.a.createElement(_.a.Footer,null,r.a.createElement(F.a,{className:"float-right",variant:"success",onClick:e.onHide},r.a.createElement(T.a,{icon:A.d})," Got it")))}var X=function(e){var a=r.a.useState(!1),t=Object(P.a)(a,2),n=t[0],l=t[1];return r.a.createElement(j.a,{fluid:!0,className:"fill-div"},r.a.createElement(F.a,{variant:"success",className:"fill-button",onClick:function(){return l(!0)}},r.a.createElement(T.a,{className:"mr-1",icon:A.f})," Sign Up"),r.a.createElement(Q,{show:n,onHide:function(){l(!1),e.onUpdate()},blob:e.blob}))},Z=t(185),ee=t(183),ae=t(177);function te(e){var a=C()(e.blob.date,"MM-DD-YYYY").format("MMMM Do"),t=e.blob.type.charAt(0).toUpperCase()+e.blob.type.slice(1);return r.a.createElement("div",null,r.a.createElement(_.a,{show:e.show,onHide:e.onHide,size:"lg",centered:!0},r.a.createElement(_.a.Header,{closeButton:!0},r.a.createElement(_.a.Title,null,t," for ",a)),r.a.createElement(_.a.Body,null,r.a.createElement(Z.a,null,r.a.createElement(Z.a.Body,null,r.a.createElement(Z.a.Subtitle,null,"Chef: ",e.blob.chef),r.a.createElement(Z.a.Text,null,e.blob.description)))),r.a.createElement(_.a.Footer,null,r.a.createElement(F.a,{variant:"success",onClick:e.onHide},r.a.createElement(T.a,{icon:A.d})," Got it"))))}var ne=function(e){var a=r.a.useState(!1),t=Object(P.a)(a,2),n=t[0],l=t[1];return r.a.createElement(j.a,{fluid:!0,className:"fill-div"},r.a.createElement(ee.a,{placement:"top",overlay:r.a.createElement(ae.a,null,e.blob.description.length<=100?e.blob.description:e.blob.description.slice(0,100)+"...")},r.a.createElement(F.a,{variant:"light",className:"fill-button",onClick:function(){return l(!0)}},"Assigned to ",r.a.createElement("em",{className:"other-username"},e.blob.chef))),r.a.createElement(te,{show:n,onHide:function(){return l(!1)},blob:e.blob}))};var re=function(e){return e.blob.hasOwnProperty("chef")?e.blob.chef===function(){var e=localStorage.getItem("username");return e.length>0?e:void 0}()?r.a.createElement($,{onUpdate:e.onUpdate,blob:e.blob}):r.a.createElement(ne,{blob:e.blob}):r.a.createElement(X,{onUpdate:e.onUpdate,blob:e.blob})};var le=function(e){return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement("div",{className:"day-of-week"},e.blob.dayOfWeek),r.a.createElement("div",null,e.blob.formattedDay)))),r.a.createElement("td",{className:"centered-cell"},r.a.createElement(re,{onUpdate:e.onUpdate,blob:e.blob.breakfastBlob})),r.a.createElement("td",{className:"centered-cell"},r.a.createElement(re,{onUpdate:e.onUpdate,blob:e.blob.lunchBlob})),r.a.createElement("td",{className:"centered-cell"},r.a.createElement(re,{onUpdate:e.onUpdate,blob:e.blob.dinnerBlob})),r.a.createElement("td",{className:"centered-cell"},r.a.createElement(re,{onUpdate:e.onUpdate,blob:e.blob.snackBlob})))};function se(e){for(var a=e.start,t=[];a.isSameOrBefore(e.end,"day");)t.push(a.format("L")),a=a.clone().add(1,"d");var n=t.map((function(a){var t=C()(a,"MM-DD-YYYY"),n={key:a,dayBlob:{formattedDay:t.format("MMMM Do"),dayOfWeek:t.format("dddd"),breakfastBlob:{date:a,type:"breakfast"},lunchBlob:{date:a,type:"lunch"},dinnerBlob:{date:a,type:"dinner"},snackBlob:{date:a,type:"snack"}}};return e.dates.hasOwnProperty(a)&&(e.dates[a].breakfast.hasOwnProperty("chef")&&(n.dayBlob.breakfastBlob.description=e.dates[a].breakfast.meal_desc,n.dayBlob.breakfastBlob.chef=e.dates[a].breakfast.chef),e.dates[a].lunch.hasOwnProperty("chef")&&(n.dayBlob.lunchBlob.description=e.dates[a].lunch.meal_desc,n.dayBlob.lunchBlob.chef=e.dates[a].lunch.chef),e.dates[a].dinner.hasOwnProperty("chef")&&(n.dayBlob.dinnerBlob.description=e.dates[a].dinner.meal_desc,n.dayBlob.dinnerBlob.chef=e.dates[a].dinner.chef),e.dates[a].snack.hasOwnProperty("chef")&&(n.dayBlob.snackBlob.description=e.dates[a].snack.meal_desc,n.dayBlob.snackBlob.chef=e.dates[a].snack.chef)),n})).map((function(a){return r.a.createElement(le,{key:a.key,onUpdate:e.onUpdate,blob:a.dayBlob})}));return r.a.createElement("div",null,r.a.createElement(D.a,{responsive:!0,striped:!0,bordered:!0,className:"mt-3"},r.a.createElement("colgroup",null,r.a.createElement("col",{className:"table-even"}),r.a.createElement("col",{className:"table-even"}),r.a.createElement("col",{className:"table-even"}),r.a.createElement("col",{className:"table-even"}),r.a.createElement("col",{className:"table-even"})),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"text-center"},"Date"),r.a.createElement("th",{className:"text-center"},"Breakfast"),r.a.createElement("th",{className:"text-center"},"Lunch"),r.a.createElement("th",{className:"text-center"},"Dinner"),r.a.createElement("th",{className:"text-center"},"Snack"))),r.a.createElement("tbody",null,n)))}var oe=function(e){var a=r.a.useState(e.opened),t=Object(P.a)(a,2),n=t[0],l=t[1],s=C()(e.start).format("MMMM Do"),o=C()(e.start).format()!==C()(e.end).startOf("day").format()?C()(e.start).month()===C()(e.end).month()?C()(e.end).format(" - Do"):C()(e.end).format(" - MMMM Do"):"";return r.a.createElement("div",null,r.a.createElement(q.a,{className:"mt-2 mb-2 text-light bg-dark-1 border border-secondary"},r.a.createElement(H.a,{xs:10},r.a.createElement("h3",null,"Week of ","".concat(s).concat(o))),r.a.createElement(H.a,{className:"toggle-collapse"},r.a.createElement(T.a,{className:"mt-2",size:"lg",onClick:function(){return l(!n)},icon:n?A.b:A.c}))),r.a.createElement(Y.a,{in:n},r.a.createElement("div",null,r.a.createElement(se,{onUpdate:e.onUpdate,start:e.start,end:e.end,dates:e.dates}))))};var ce=function(e){return r.a.createElement(I.a,{className:"mt-2",variant:"danger"},r.a.createElement(I.a.Heading,null,"Session timed out."),r.a.createElement("p",null,"Please ",r.a.createElement(I.a.Link,{href:"/login",onClick:e.onLogout},"log out")," and log in again."))};var me=function(e){var a=C()().startOf("day"),t=a.clone().endOf("week"),n=t.clone().add(1,"d").startOf("day"),l=n.clone().endOf("week"),s=l.clone().add(1,"d").startOf("day"),o=s.clone().endOf("week"),c=o.clone().add(1,"d").startOf("day"),m=c.clone().endOf("week"),i=m.clone().add(1,"d").startOf("day"),d=i.clone().endOf("week");return r.a.createElement(j.a,null,e.stale&&r.a.createElement(ce,{onLogout:e.onLogout}),r.a.createElement("h1",{className:"mt-4 mb-4"},"Upcoming Meals"),r.a.createElement(oe,{opened:!0,onUpdate:e.onUpdate,start:a,end:t,dates:e.dates}),r.a.createElement(oe,{opened:!1,onUpdate:e.onUpdate,start:n,end:l,dates:e.dates}),r.a.createElement(oe,{opened:!1,onUpdate:e.onUpdate,start:s,end:o,dates:e.dates}),r.a.createElement(oe,{opened:!1,onUpdate:e.onUpdate,start:c,end:m,dates:e.dates}),r.a.createElement(oe,{opened:!1,onUpdate:e.onUpdate,start:i,end:d,dates:e.dates}))};var ie=function(e){return r.a.createElement("div",{className:"mt-3 mb-3 text-center"},"Made by Liversticks. Check out the source code ",r.a.createElement("a",{href:"https://github.com/Liversticks/meal-client"},"here."))},de=J.meal_url,ue=J.login_url,pe=J.signup_url,be=function(e){Object(i.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).logout=n.logout.bind(Object(m.a)(n)),n.state={currentUser:f()?f():void 0,mealList:[],loginStale:!1},n.update=n.update.bind(Object(m.a)(n)),n}return Object(c.a)(t,[{key:"update",value:function(){var e=this,a=f();a&&this.setState({currentUser:a}),E.a.get(de,{headers:h()}).then((function(a){e.setState({mealList:a.data})})).catch((function(t){console.log(t.toString()),a&&e.setState({loginStale:!0})}))}},{key:"signup",value:function(){return E.a.post()}},{key:"login",value:function(e,a){return E.a.post(ue,{username:e,password:a})}},{key:"onSignup",value:function(e,a,t){return E.a.post(pe,{username:e,email:a,password:t})}},{key:"logout",value:function(){localStorage.removeItem("user"),localStorage.removeItem("username"),this.setState({loginStale:!1})}},{key:"componentDidMount",value:function(){this.update()}},{key:"render",value:function(){return r.a.createElement(u.BrowserRouter,null,r.a.createElement(N,{isLoggedIn:void 0!==this.state.currentUser,onLogout:this.logout}),r.a.createElement("div",null,r.a.createElement(p.g,null,r.a.createElement(p.d,{exact:!0,path:["/","/meals"]},this.state.currentUser?r.a.createElement(me,{onLogout:this.logout,stale:this.state.loginStale,onUpdate:this.update,dates:this.state.mealList}):r.a.createElement(p.c,{to:"/login"})),r.a.createElement(p.d,{exact:!0,path:"/login"},this.state.currentUser?r.a.createElement(p.c,{to:"/meals"}):r.a.createElement(L,{onLogin:this.login,onLoginSuccess:this.update})),r.a.createElement(p.d,{exact:!0,path:"/signup"},this.state.currentUser?r.a.createElement(p.c,{to:"/meals"}):r.a.createElement(O,{onSignup:this.onSignup})))),r.a.createElement("div",null,r.a.createElement(ie,null)))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(be,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[134,1,2]]]);
//# sourceMappingURL=main.9cc6f2ae.chunk.js.map