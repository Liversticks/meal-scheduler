(this["webpackJsonpmeal-client"]=this["webpackJsonpmeal-client"]||[]).push([[0],{119:function(e,a,t){e.exports=t(151)},141:function(e,a,t){},151:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(45),s=t.n(l),c=t(38),o=t(39),m=t(73),i=t(67),d=t(66),u=t(51),p=t(7),b=(t(124),t(35)),E=t.n(b);t(141);function f(){return JSON.parse(localStorage.getItem("user"))}function h(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.accessToken?{"x-access-token":e.accessToken}:{}}var g=t(10),v=t(8),y=v.a().shape({username:v.c().required("Username is required"),email:v.c().email("Email is invalid").required("Email is required"),password:v.c().min(10,"Password must be at least 10 characters long").required("Password is required"),confirmPassword:v.c().oneOf([v.b("password"),null],"Passwords must match").required("Must confirm password")}),N=function(e){Object(i.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).state={message:""},n}return Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"jumbotron"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 offset-md-3"},r.a.createElement("h3",{className:"pb-2"},"Signup"),r.a.createElement(g.c,{initialValues:{username:"",email:"",password:"",confirmPassword:""},validationSchema:y,onSubmit:function(a,t){e.props.onSignup(a.username,a.email,a.password).then((function(a){a.data.message&&"Signed up successfully!"===a.data.message&&(e.setState({message:a.data.message}),setTimeout((function(){e.props.history.push("/login")}),2e3))})).catch((function(a){var n=a.response&&a.response.data&&a.response.data.message||a.message||a.toString();e.setState({message:n}),t.setSubmitting(!1)}))}},(function(a){var t=a.errors,n=a.touched;return r.a.createElement(g.b,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement(g.a,{name:"username",type:"text",className:"form-control"}),n.username&&t.username&&r.a.createElement("div",{className:"alert alert-danger mt-2"},t.username)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email Address"),r.a.createElement(g.a,{name:"email",type:"text",className:"form-control"}),n.email&&t.email&&r.a.createElement("div",{className:"alert alert-danger mt-2"},t.email)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(g.a,{name:"password",type:"password",className:"form-control"}),n.password&&t.password&&r.a.createElement("div",{className:"alert alert-danger mt-2"},t.password)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm Password"),r.a.createElement(g.a,{name:"confirmPassword",type:"password",className:"form-control"}),n.confirmPassword&&t.confirmPassword&&r.a.createElement("div",{className:"alert alert-danger mt-2"},t.confirmPassword)),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary mr-2"},"Sign Up"),r.a.createElement("button",{type:"reset",className:"btn btn-secondary"},"Reset")),e.state.message&&r.a.createElement("div",{className:"Signed up successfully!"===e.state.message?"alert alert-success mt-2":"alert alert-danger mt-2"},e.state.message))}))))))}}]),t}(r.a.Component),w=Object(p.g)(N),k=v.a().shape({username:v.c().required("Please enter your username."),password:v.c().required("Please enter your password.")}),S=function(e){Object(i.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).state={message:""},n}return Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"jumbotron"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 offset-md-3"},r.a.createElement("h3",{className:"pb-2"},"Meals App"),r.a.createElement(g.c,{initialValues:{username:"",password:""},validationSchema:k,onSubmit:function(a,t){e.props.onLogin(a.username,a.password).then((function(t){t.data.accessToken&&(localStorage.setItem("user",JSON.stringify(t.data)),localStorage.setItem("username",a.username)),e.props.onLoginSuccess(),e.props.history.push("/meals")})).catch((function(a){var n=a.response&&a.response.data&&a.response.data.message||a.message||a.toString();e.setState({message:n}),t.setSubmitting(!1)}))}},(function(a){var t=a.errors,n=a.touched,l=a.isSubmitting,s=a.isValidating;return r.a.createElement(g.b,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"align-middle",htmlFor:"username"},"Username"),r.a.createElement(g.a,{name:"username",type:"text",className:"form-control"}),n.username&&t.username&&r.a.createElement("div",{className:"alert alert-danger mt-2"},t.username)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(g.a,{name:"password",type:"password",className:"form-control"}),n.password&&t.password&&r.a.createElement("div",{className:"alert alert-danger mt-2"},t.password)),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary",type:"submit",disabled:l},(l||s)&&r.a.createElement("span",{className:"spinner-border spinner-border-sm"}),r.a.createElement("span",null,"Login"))),e.state.message&&r.a.createElement("div",{className:"alert alert-danger mt-2"},e.state.message))}))))))}}]),t}(r.a.Component),M=Object(p.g)(S),O=t(155),U=t(16),B=t.n(U),j=t(32),x=t(157),P=t(158),D=t(156),q=t(159),C=t(160),L=t(153),H=t(154),Y=t(30),_=t(25),F={meal_url:"https://ls-meal-app.herokuapp.com/api/meals",login_url:"https://ls-meal-app.herokuapp.com/api/login",signup_url:"https://ls-meal-app.herokuapp.com/api/signup"},I=F.meal_url,T=new(function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,[{key:"newMeal",value:function(e,a,t){return E.a.post(I,{date:e,meal_type:a,meal_desc:t},{headers:h()})}},{key:"editMeal",value:function(e,a,t){return E.a.put(I,{date:e,meal_type:a,meal_desc:t},{headers:h()})}},{key:"deleteMeal",value:function(e,a){return E()({url:I,method:"delete",headers:h(),data:{date:e,meal_type:a}})}}]),e}()),A=v.a().shape({description:v.c().required("Please describe your meal."),date:v.c().required(),type:v.c().required()}),J=["Meal details updated successfully!","Meal successfully deleted."];function V(e){var a=r.a.useState(""),t=Object(j.a)(a,2),n=t[0],l=t[1],s=B()(e.blob.date,"MM-DD-YYYY").format("MMMM Do"),c=e.blob.type.charAt(0).toUpperCase()+e.blob.type.slice(1);return r.a.createElement(C.a,{show:e.show,onHide:e.onHide,size:"lg",centered:!0},r.a.createElement(C.a.Header,{closeButton:!0},r.a.createElement(C.a.Title,null,c," for ",s)),r.a.createElement(C.a.Body,null,n.length>0?r.a.createElement(L.a,{variant:J.includes(n)?"success":"danger"},n):r.a.createElement(g.c,{initialValues:{date:e.blob.date,type:e.blob.type,description:e.blob.description},validationSchema:A,onSubmit:function(e,a){T.editMeal(e.date,e.type,e.description).then((function(e){l(e.data.message)})).catch((function(e){e.response?l(e.response.data.message):e.request?l(e.request):l(e.message)})),a.setSubmitting(!1)}},(function(e){var a=e.errors,t=e.touched;return r.a.createElement(g.b,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"description"},"Meal description"),r.a.createElement(g.a,{name:"description",component:"textarea",className:"form-control",rows:"6"}),r.a.createElement("small",{className:"form-text text-muted"},"Change of heart? New meal ideas are always welcome."),t.description&&a.description&&r.a.createElement("div",{className:"alert alert-danger mt-2"},a.description)),r.a.createElement(H.a,{className:"float-right",type:"submit"},"Submit"))}))),r.a.createElement(C.a.Footer,null,""===n?r.a.createElement(H.a,{variant:"danger",onClick:function(){T.deleteMeal(e.blob.date,e.blob.type).then((function(e){l(e.data.message)})).catch((function(e){e.response?(l(e.response.data.message),console.log("first branch")):e.request?(l(e.request),console.log("second branch")):(console.log("third branch"),l(e.message)),console.log(e)}))}},r.a.createElement(Y.a,{icon:_.e})," Delete Meal"):r.a.createElement(H.a,{variant:"success",onClick:function(){e.onHide(),l("")}},r.a.createElement(Y.a,{icon:_.d})," Got it")))}var W=function(e){var a=r.a.useState(!1),t=Object(j.a)(a,2),n=t[0],l=t[1];return r.a.createElement(O.a,{fluid:!0},r.a.createElement(H.a,{className:"fill-button",variant:"info",onClick:function(){return l(!0)}},r.a.createElement(Y.a,{className:"mr-1",icon:_.a})," Modify"),r.a.createElement(V,{show:n,onHide:function(){l(!1),e.onUpdate()},blob:e.blob}))},z=v.a().shape({description:v.c().required("Please describe your meal."),date:v.c().required(),type:v.c().required()});function G(e){var a=r.a.useState(""),t=Object(j.a)(a,2),n=t[0],l=t[1],s=B()(e.blob.date,"MM-DD-YYYY").format("MMMM Do"),c=e.blob.type.charAt(0).toUpperCase()+e.blob.type.slice(1);return r.a.createElement(C.a,{show:e.show,onHide:e.onHide,size:"lg",centered:!0},r.a.createElement(C.a.Header,{closeButton:!0},r.a.createElement(C.a.Title,null,c," for ",s)),r.a.createElement(C.a.Body,null,n.length>0?r.a.createElement(L.a,{variant:"Meal scheduled successfully!"===n?"success":"danger"},n):r.a.createElement(g.c,{initialValues:{date:e.blob.date,type:e.blob.type,description:""},validationSchema:z,onSubmit:function(e,a){T.newMeal(e.date,e.type,e.description).then((function(e){l(e.data.message)})).catch((function(e){e.response?l(e.response.data.message):e.request?l(e.request):l(e.message)}))}},(function(e){var a=e.errors,t=e.touched;return r.a.createElement(g.b,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"description"},"Meal description"),r.a.createElement(g.a,{name:"description",component:"textarea",className:"form-control",rows:"6"}),r.a.createElement("small",{className:"form-text text-muted"},"Describe the meal you will prepare."),t.description&&a.description&&r.a.createElement("div",{className:"alert alert-danger mt-2"},a.description)),r.a.createElement(H.a,{className:"float-right",type:"submit"},"Submit"))}))),n.length>0&&r.a.createElement(C.a.Footer,null,r.a.createElement(H.a,{className:"float-right",variant:"success",onClick:e.onHide},r.a.createElement(Y.a,{icon:_.d})," Got it")))}var R=function(e){var a=r.a.useState(!1),t=Object(j.a)(a,2),n=t[0],l=t[1];return r.a.createElement(O.a,{fluid:!0,className:"fill-div"},r.a.createElement(H.a,{variant:"success",className:"fill-button",onClick:function(){return l(!0)}},r.a.createElement(Y.a,{className:"mr-1",icon:_.f})," Sign Up"),r.a.createElement(G,{show:n,onHide:function(){l(!1),e.onUpdate()},blob:e.blob}))},$=t(161);function K(e){var a=B()(e.blob.date,"MM-DD-YYYY").format("MMMM Do"),t=e.blob.type.charAt(0).toUpperCase()+e.blob.type.slice(1);return r.a.createElement("div",null,r.a.createElement(C.a,{show:e.show,onHide:e.onHide,size:"lg",centered:!0},r.a.createElement(C.a.Header,{closeButton:!0},r.a.createElement(C.a.Title,null,t," for ",a)),r.a.createElement(C.a.Body,null,r.a.createElement($.a,null,r.a.createElement($.a.Body,null,r.a.createElement($.a.Subtitle,null,"Chef: ",e.blob.chef),r.a.createElement($.a.Text,null,e.blob.description)))),r.a.createElement(C.a.Footer,null,r.a.createElement(H.a,{variant:"success",onClick:e.onHide},r.a.createElement(Y.a,{icon:_.d})," Got it"))))}var Q=function(e){var a=r.a.useState(!1),t=Object(j.a)(a,2),n=t[0],l=t[1];return r.a.createElement(O.a,{fluid:!0,className:"fill-div"},r.a.createElement(H.a,{variant:"light",className:"fill-button",onClick:function(){return l(!0)}},"Assigned to ",r.a.createElement("em",{className:"other-username"},e.blob.chef)),r.a.createElement(K,{show:n,onHide:function(){return l(!1)},blob:e.blob}))};var X=function(e){return e.blob.hasOwnProperty("chef")?e.blob.chef===function(){var e=localStorage.getItem("username");return e.length>0?e:void 0}()?r.a.createElement(W,{onUpdate:e.onUpdate,blob:e.blob}):r.a.createElement(Q,{blob:e.blob}):r.a.createElement(R,{onUpdate:e.onUpdate,blob:e.blob})};var Z=function(e){return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("div",null,r.a.createElement(D.a,null,r.a.createElement("div",{className:"day-of-week"},e.blob.dayOfWeek),r.a.createElement("div",null,e.blob.formattedDay)))),r.a.createElement("td",{className:"centered-cell"},r.a.createElement(X,{onUpdate:e.onUpdate,blob:e.blob.breakfastBlob})),r.a.createElement("td",{className:"centered-cell"},r.a.createElement(X,{onUpdate:e.onUpdate,blob:e.blob.lunchBlob})),r.a.createElement("td",{className:"centered-cell"},r.a.createElement(X,{onUpdate:e.onUpdate,blob:e.blob.dinnerBlob})),r.a.createElement("td",{className:"centered-cell"},r.a.createElement(X,{onUpdate:e.onUpdate,blob:e.blob.snackBlob})))};function ee(e){for(var a=e.start,t=[];a.isSameOrBefore(e.end,"day");)t.push(a.format("L")),a=a.clone().add(1,"d");var n=t.map((function(a){var t=B()(a,"MM-DD-YYYY"),n={key:a,dayBlob:{formattedDay:t.format("MMMM Do"),dayOfWeek:t.format("dddd"),breakfastBlob:{date:a,type:"breakfast"},lunchBlob:{date:a,type:"lunch"},dinnerBlob:{date:a,type:"dinner"},snackBlob:{date:a,type:"snack"}}};return e.dates.hasOwnProperty(a)&&(e.dates[a].breakfast.hasOwnProperty("chef")&&(n.dayBlob.breakfastBlob.description=e.dates[a].breakfast.meal_desc,n.dayBlob.breakfastBlob.chef=e.dates[a].breakfast.chef),e.dates[a].lunch.hasOwnProperty("chef")&&(n.dayBlob.lunchBlob.description=e.dates[a].lunch.meal_desc,n.dayBlob.lunchBlob.chef=e.dates[a].lunch.chef),e.dates[a].dinner.hasOwnProperty("chef")&&(n.dayBlob.dinnerBlob.description=e.dates[a].dinner.meal_desc,n.dayBlob.dinnerBlob.chef=e.dates[a].dinner.chef),e.dates[a].snack.hasOwnProperty("chef")&&(n.dayBlob.snackBlob.description=e.dates[a].snack.meal_desc,n.dayBlob.snackBlob.chef=e.dates[a].snack.chef)),n})).map((function(a){return r.a.createElement(Z,{key:a.key,onUpdate:e.onUpdate,blob:a.dayBlob})}));return r.a.createElement("div",null,r.a.createElement(x.a,{striped:!0,bordered:!0,className:"mt-3"},r.a.createElement("colgroup",null,r.a.createElement("col",{className:"table-even"}),r.a.createElement("col",{className:"table-even"}),r.a.createElement("col",{className:"table-even"}),r.a.createElement("col",{className:"table-even"}),r.a.createElement("col",{className:"table-even"})),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"text-center"},"Date"),r.a.createElement("th",{className:"text-center"},"Breakfast"),r.a.createElement("th",{className:"text-center"},"Lunch"),r.a.createElement("th",{className:"text-center"},"Dinner"),r.a.createElement("th",{className:"text-center"},"Snack"))),r.a.createElement("tbody",null,n)))}var ae=function(e){var a=r.a.useState(e.opened),t=Object(j.a)(a,2),n=t[0],l=t[1],s=B()(e.start).format("MMMM Do"),c=B()(e.start).month()===B()(e.end).month()?B()(e.end).format("Do"):B()(e.end).format("MMMM Do");return r.a.createElement("div",null,r.a.createElement(P.a,{className:"mt-2 mb-2 text-light bg-dark-1 border border-secondary"},r.a.createElement(D.a,{xs:10},r.a.createElement("h3",null,"Week of ","".concat(s," - ").concat(c))),r.a.createElement(D.a,{className:"toggle-collapse"},r.a.createElement(Y.a,{className:"mt-2",size:"lg",onClick:function(){return l(!n)},icon:n?_.b:_.c}))),r.a.createElement(q.a,{in:n},r.a.createElement("div",null,r.a.createElement(ee,{onUpdate:e.onUpdate,start:e.start,end:e.end,dates:e.dates}))))};var te=function(e){return r.a.createElement(L.a,{className:"mt-2",variant:"danger"},r.a.createElement(L.a.Heading,null,"Session timed out."),r.a.createElement("p",null,"Please ",r.a.createElement(L.a.Link,{href:"/login",onClick:e.onLogout},"log out")," and log in again."))};var ne=function(e){var a=B()().startOf("day"),t=a.clone().endOf("week"),n=t.clone().add(1,"d").startOf("day"),l=n.clone().endOf("week"),s=l.clone().add(1,"d").startOf("day"),c=s.clone().endOf("week"),o=c.clone().add(1,"d").startOf("day"),m=o.clone().endOf("week"),i=m.clone().add(1,"d").startOf("day"),d=i.clone().endOf("week");return r.a.createElement(O.a,null,e.stale&&r.a.createElement(te,{onLogout:e.onLogout}),r.a.createElement("h1",{className:"mt-4 mb-4"},"Upcoming Meals"),r.a.createElement(ae,{opened:!0,onUpdate:e.onUpdate,start:a,end:t,dates:e.dates}),r.a.createElement(ae,{opened:!1,onUpdate:e.onUpdate,start:n,end:l,dates:e.dates}),r.a.createElement(ae,{opened:!1,onUpdate:e.onUpdate,start:s,end:c,dates:e.dates}),r.a.createElement(ae,{opened:!1,onUpdate:e.onUpdate,start:o,end:m,dates:e.dates}),r.a.createElement(ae,{opened:!1,onUpdate:e.onUpdate,start:i,end:d,dates:e.dates}))};var re=function(e){return r.a.createElement("div",{className:"mt-3 mb-3 text-center"},"Made by Liversticks. Check out the source code ",r.a.createElement("a",{href:"https://github.com/Liversticks/meal-client"},"here."))},le=F.meal_url,se=F.login_url,ce=F.signup_url,oe=function(e){Object(i.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).logout=n.logout.bind(Object(m.a)(n)),n.state={currentUser:f()?f():void 0,mealList:[],loginStale:!1},n.update=n.update.bind(Object(m.a)(n)),n}return Object(o.a)(t,[{key:"update",value:function(){var e=this,a=f();a&&this.setState({currentUser:a}),E.a.get(le,{headers:h()}).then((function(a){e.setState({mealList:a.data})})).catch((function(t){console.log(t.toString()),a&&e.setState({loginStale:!0})}))}},{key:"signup",value:function(){return E.a.post()}},{key:"login",value:function(e,a){return E.a.post(se,{username:e,password:a})}},{key:"onSignup",value:function(e,a,t){return E.a.post(ce,{username:e,email:a,password:t})}},{key:"logout",value:function(){localStorage.removeItem("user"),localStorage.removeItem("username"),this.setState({loginStale:!1})}},{key:"componentDidMount",value:function(){this.update()}},{key:"render",value:function(){return r.a.createElement(u.a,null,r.a.createElement("div",null,r.a.createElement("nav",{className:"navbar navbar-expand-sm navbar-dark bg-dark sticky-top"},r.a.createElement(u.b,{to:"/",className:"navbar-brand"},"Meals"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navcollapse"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navcollapse"},this.state.currentUser?r.a.createElement("ul",{className:"navbar-nav mr-auto mt-2 mt-lg-0"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{href:"/login",className:"nav-link",onClick:this.logout},"Logout"))):r.a.createElement("ul",{className:"navbar-nav mr-auto mt-2 mt-lg-0"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(u.b,{to:"/login",className:"nav-link"},"Login")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(u.b,{to:"/signup",className:"nav-link"},"Signup"))))),r.a.createElement("div",null,r.a.createElement(p.d,null,r.a.createElement(p.b,{exact:!0,path:["/","/meals"]},this.state.currentUser?r.a.createElement(ne,{onLogout:this.logout,stale:this.state.loginStale,onUpdate:this.update,dates:this.state.mealList}):r.a.createElement(p.a,{to:"/login"})),r.a.createElement(p.b,{exact:!0,path:"/login"},this.state.currentUser?r.a.createElement(p.a,{to:"/meals"}):r.a.createElement(M,{onLogin:this.login,onLoginSuccess:this.update})),r.a.createElement(p.b,{exact:!0,path:"/signup"},this.state.currentUser?r.a.createElement(p.a,{to:"/meals"}):r.a.createElement(w,{onSignup:this.onSignup})))),r.a.createElement("div",null,r.a.createElement(re,null))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(oe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[119,1,2]]]);
//# sourceMappingURL=main.5ee84bc1.chunk.js.map